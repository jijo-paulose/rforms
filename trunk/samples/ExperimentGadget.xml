<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Gadget Wrapper" author_email="mpalmer@gmail.com" description="Shows whatever url in an iframe that is provided in the url user preference." height="500">
  </ModulePrefs>
	<UserPref name="templateSrc" datatype="string" 
               default_value=""/>
	<UserPref name="rdfSrc" datatype="string" 
               default_value=""/>
  <Content type="html"><![CDATA[
  	<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.6.1/dojo/dojo.js" 
		djConfig="parseOnLoad: true" type="text/javascript"></script>
	<script type="text/javascript" src="http://rforms.googlecode.com/files/rforms_ROOT.js"></script>
	<script type="text/javascript" src="http://rforms.googlecode.com/files/rforms.js"></script>
	<style>
		@import "http://ajax.googleapis.com/ajax/libs/dojo/1.6.1/dijit/themes/tundra/tundra.css";
		@import "http://rforms.googlecode.com/files/rforms.css";
	</style>
	<script>
		gadgets.util.registerOnLoadHandler(function(){
			dojo.require("rforms.apps.Experiment");		
			var prefs = new gadgets.Prefs();
			var templateSrc = prefs.getString("templateSrc");
			dojo.addOnLoad(function() {
				var params = {};
				params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
				gadgets.io.makeRequest(templateSrc, function(response) {
					var e = new rforms.apps.Experiment({templateObj: response.data, graphObj: {}, hideTemplate: true}, "container");
					e.startup();
				});
			});
		});
	</script>
	<div style="width:100%;height:100%" id="container"></div>
	<iframe id="content" src="" width="100%" height="100%" frameborder="0"></iframe>
	<script type="text/javascript">
		gadgets.util.registerOnLoadHandler(function(){
			var prefs = new gadgets.Prefs();
			var url = prefs.getString("url");
			document.getElementById("content").src = url;
		});
	</script>
  ]]></Content>
</Module>
