<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Gadget Wrapper" author_email="mpalmer@gmail.com" description="Shows whatever url in an iframe that is provided in the url user preference." height="500">
	<Optional feature="content-rewrite">
	    <Param name="exclude-url">*</Param>
	</Optional>
  </ModulePrefs>
	<UserPref name="templateSrc" datatype="string" 
               default_value=""/>
	<UserPref name="rdfSrc" datatype="string" 
               default_value=""/>
  <Content type="html"><![CDATA[
  	<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.6.1/dojo/dojo.js" 
		djConfig="parseOnLoad: true, locale: 'ROOT'" type="text/javascript"></script>
	<script type="text/javascript" src="http://rforms.googlecode.com/files/rforms_ROOT.js"></script>
	<script type="text/javascript" src="http://rforms.googlecode.com/files/rforms.js"></script>
	<style>
		@import "http://ajax.googleapis.com/ajax/libs/dojo/1.6.1/dijit/themes/tundra/tundra.css";
		@import "http://rforms.googlecode.com/svn/trunk/src/rforms/view/resources/rforms.css";
		body, html {
			height:100%;
			width: 100%;
			margin: 0px;
			padding: 0px;
		}
	</style>
	<script>
		gadgets.util.registerOnLoadHandler(function(){
			dojo.require("rforms.apps.Experiment");		
			var prefs = new gadgets.Prefs();
			var templateSrc = prefs.getString("templateSrc");
			dojo.addOnLoad(function() {
				var params = {};
				params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
				gadgets.io.makeRequest(templateSrc, function(response) {
					var e = new rforms.apps.Experiment({templateObj: dojo.fromJson(response.data), graphObj: {}, hideTemplate: true}, "container");
					e.startup();
				});
			});
		});
	</script>
	<div class="tundra" style="width:100%;height:100%">
		<div style="width:100%;height:100%" id="container"></div>
	</div>
	<iframe id="content" src="" width="100%" height="100%" frameborder="0"></iframe>
  ]]></Content>
</Module>
