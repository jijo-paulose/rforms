<html>
  <head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title></title>
  </head>
  <body>
	<script type="text/javascript" src="../../../../lib/dojo/dojo/dojo.js.uncompressed.js"
		djConfig="isDebug: true, debugAtAllCosts: true, parseOnLoad: false, usePlainJson: true"></script>
	<script type="text/javascript">
		dojo.registerModulePath("rforms","../../../src/rforms");
		dojo.registerModulePath("rdfjson","../../../src/rdfjson");
		dojo.require("rforms.model.Engine");
		dojo.require("rforms.model.GroupBinding");
		dojo.require("rforms.model.PropertyGroupBinding");
		dojo.require("rforms.model.ValueBinding");
		dojo.require("rforms.template.ItemStore");
		dojo.require("rdfjson.Graph");
		dojo.require("rdfjson.tests.data");
		dojo.require("rforms.template.tests.data");

		dojo.addOnLoad(function() {
			var doh = {};
			doh.t = function(val) {
				if (!val) {
					alert("doh error");
				}
			};
			doh.f = function(val) {
				if (val) {
					alert("doh error");
				} 
			};
			debugger;

			//Paste code from the tests below (within start and end mark) to be able to debug them,
			//remove any use of doh to allow independent debugging.
			//-------------------------START----------------------------------------

	this.itemStore = new rforms.template.ItemStore();
	this.template = this.itemStore.createTemplate(rforms.template.tests.template1);
	this.graph = new rdfjson.Graph({});
	this.root = new rforms.model.GroupBinding({item: this.template.getRoot(), childrenRootUri: "http://example.org/about", graph: this.graph});

		var pGroupBinding = rforms.model.create(this.root, this.template.getRoot().getChildren()[4]);
		doh.t(pGroupBinding.getParent() === this.root);
		doh.t(pGroupBinding.isValid() === false);
		doh.t(this.graph.find().length === 0);
		var groupBinding = pGroupBinding.getObjectBinding();
		var valueBinding = rforms.model.create(groupBinding, groupBinding.getItem().getChildren()[0]);
		doh.t(groupBinding.isValid() === false);
		doh.t(pGroupBinding.isValid() === false);
		doh.t(valueBinding.isValid() === false);
		doh.t(this.graph.find().length === 0);
		valueBinding.setValue("Pete");
		doh.t(groupBinding.isValid() === false);
		doh.t(pGroupBinding.isValid() === false);
		doh.t(valueBinding.isValid() === true);
		doh.t(this.graph.find().length === 0);
		pGroupBinding.getPredicateBinding().setValue("http://purl.org/dc/terms/creator");
		doh.t(groupBinding.isValid() === true);
		doh.t(pGroupBinding.isValid() === true);
		doh.t(valueBinding.isValid() === true);
		doh.t(this.graph.find().length === 3);
			//-------------------------END----------------------------------------
			console.log("A sensless log entry, to be able to step over last code row in firebug above.")
		});
	</script>
  </body>
</html>
